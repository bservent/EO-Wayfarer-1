{% extends 'base.html' %}

{% block content %}
<br>
<br>
<a href="{% url 'authors_index' %}"><h3> ‚Üê back</h3></a>

<div class="container-fluid mt-5 pt-5">
	<h1 class="article-header mb-5">{{ article.city }}</h1>
	<div class="row">
		<div class="col-xl-4">
			<h2>Profile Pic will go here</h2>
			<h2>Article by: {{ article.author }}</h2>
		</div>
		<div class="col-xl-8">
			<span>
				<h1>{{ article.title }}</h1>
				<p>Article Content: {{ article.content }}</p>
				<p>Article Created On: {{ article.created_on }}</p>
			</span>

    	<div class="col-md-8 card mb-4  mt-3 ">
      		<div class="card-body">
        		<!-- comments -->
        		<h2>{{ comments.count }} comments</h2>

				{% for comment in comments %}
        			<div class="comments" style="padding: 10px;">
          				<p class="font-weight-bold">
            				{{ comment.name }}
            			<span class=" text-muted font-weight-normal">
              				{{ comment.created_on }}
            			</span>
          			</p>
          			{{ comment.body | linebreaks }}
        		</div>
        		{% endfor %}
			</div>
		</div>
			<div class="card-body">
				{% load crispy_forms_tags %}
				{% comment %} {% if new_comment %}
				<div class="alert alert-success" role="alert">
					Your comment is awaiting moderation
				</div>
				{% else %} {% endcomment %}
				<h3>Leave a comment</h3>
				<form method="post" style="margin-top: 1.3em;">
					{{ comment_form | crispy }}
					{% csrf_token %}
					<button type="submit" class="btn btn-primary  btn-lg">Submit</button>
				</form>
				{% comment %} {% endif %} {% endcomment %}
			</div>
		

			  {% if article.author.id == request.user.id %}
			  <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-target="#editArticleModal">
				  DELETE
				</button>
			  <div class="modal fade" id="editArticleModal" tabindex="-1" role="dialog" aria-labelledby="articleModalTitle" aria-hidden="true">
				  <div class="modal-dialog modal-dialog-centered" role="document">
					  <div class="modal-content">
						  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
						  <span class="float-right mr-2 aria-hidden="true">&times;</span>
						  </button>
					  <div class="modal-body">
						  Are you sure you want to delete this article?
					  </div>
					  <div class="modal-footer">
						  <form action="{% url 'delete_article' article.id %}" method="POST">
							  {% csrf_token %}
							  <input type="submit" class="btn btn-outline-danger" value="DELETE">
							  <a href="{% url 'article_detail' article.id %}" class="btn btn-outline-secondary text-uppercase">CANCEL</a>
						  </form>
					  </div>
					  </div>
				  </div>
			  </div>
			  <a href="{% url 'edit_article' article.id %}" class="btn btn-outline-info text-dark text-uppercase">EDIT</a>
			  {% endif %}
			</div>
		</div>
	</div>
</div>
{% endblock %}